# ğŸ”’ å®‰å…¨æ‰«æè‡ªåŠ¨åŒ–ç³»ç»Ÿæ–‡æ¡£

## æ¦‚è¿°

æœ¬é¡¹ç›®é›†æˆäº†å…¨é¢çš„å®‰å…¨æ‰«æè‡ªåŠ¨åŒ–ç³»ç»Ÿï¼ŒåŒ…æ‹¬ä¾èµ–æ¼æ´æ‰«æã€ä»£ç å®‰å…¨åˆ†æã€é…ç½®å®‰å…¨æ£€æŸ¥ã€å¯†é’¥æ£€æµ‹ç­‰åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ” ä¾èµ–æ¼æ´æ‰«æ

è‡ªåŠ¨æ£€æµ‹é¡¹ç›®ä¾èµ–ä¸­çš„å·²çŸ¥å®‰å…¨æ¼æ´ï¼š

- **npm audit**: å®˜æ–¹ npm æ¼æ´æ‰«æ
- **Trivy**: é«˜çº§æ¼æ´æ‰«æå™¨
- **Dependabot**: è‡ªåŠ¨åŒ–ä¾èµ–æ›´æ–°
- **è®¸å¯è¯åˆè§„æ€§**: æ£€æŸ¥ä¾èµ–è®¸å¯è¯å…¼å®¹æ€§

### ğŸ” ä»£ç å®‰å…¨åˆ†æ

é™æ€ä»£ç åˆ†ææ£€æµ‹æ½œåœ¨å®‰å…¨é—®é¢˜ï¼š

- **ESLint Security Plugin**: å®æ—¶å®‰å…¨ä»£ç æ£€æŸ¥
- **Semgrep**: é«˜çº§å®‰å…¨æ¨¡å¼æ£€æµ‹
- **SonarJS**: ä»£ç è´¨é‡å’Œå®‰å…¨åˆ†æ
- **CodeQL**: GitHub è¯­ä¹‰ä»£ç åˆ†æ

### ğŸ” å¯†é’¥æ£€æµ‹

é˜²æ­¢æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼š

- **TruffleHog**: Git å†å²å¯†é’¥æ‰«æ
- **GitLeaks**: ä»“åº“å¯†é’¥æ£€æµ‹
- **Pre-commit hooks**: æäº¤å‰å¯†é’¥æ£€æŸ¥
- **ç¯å¢ƒå˜é‡å®‰å…¨**: é…ç½®æ–‡ä»¶å®‰å…¨æ£€æŸ¥

### ğŸ—ï¸ åŸºç¡€è®¾æ–½å®‰å…¨

é…ç½®å’ŒåŸºç¡€è®¾æ–½å®‰å…¨æ£€æŸ¥ï¼š

- **å®‰å…¨å¤´æ£€æŸ¥**: HTTP å®‰å…¨å¤´é…ç½®éªŒè¯
- **CSP ç­–ç•¥**: å†…å®¹å®‰å…¨ç­–ç•¥åˆ†æ
- **HTTPS é…ç½®**: SSL/TLS é…ç½®æ£€æŸ¥
- **API å®‰å…¨**: API ç«¯ç‚¹å®‰å…¨éªŒè¯

## ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ä½¿ç”¨

#### è¿è¡Œå®Œæ•´å®‰å…¨æ‰«æ
```bash
npm run security:full
```

#### å¿«é€Ÿå®‰å…¨æ£€æŸ¥
```bash
npm run security:quick
```

#### å•ç‹¬è¿è¡Œå„ä¸ªæ‰«æ
```bash
# ä¾èµ–æ¼æ´æ‰«æ
npm run security:scan

# é…ç½®å®‰å…¨æ£€æŸ¥
npm run security:config

# éªŒè¯å®‰å…¨è‡ªåŠ¨åŒ–é…ç½®
npm run verify:security
```

### è‡ªåŠ¨åŒ–æ‰«æ

#### GitHub Actions å·¥ä½œæµ

å®‰å…¨æ‰«æåœ¨ä»¥ä¸‹æƒ…å†µè‡ªåŠ¨è§¦å‘ï¼š

- **æ¨é€åˆ°ä¸»åˆ†æ”¯**: å®Œæ•´å®‰å…¨æ‰«æ
- **Pull Request**: å¢é‡å®‰å…¨æ£€æŸ¥
- **å®šæ—¶æ‰«æ**: æ¯æ—¥å‡Œæ™¨ 2 ç‚¹è‡ªåŠ¨æ‰«æ
- **æ‰‹åŠ¨è§¦å‘**: æ”¯æŒæ‰‹åŠ¨è¿è¡Œç‰¹å®šç±»å‹çš„æ‰«æ

#### Pre-commit é’©å­

æ¯æ¬¡æäº¤å‰è‡ªåŠ¨è¿è¡Œï¼š

- ä¾èµ–æ¼æ´æ£€æŸ¥
- ä»£ç å®‰å…¨åˆ†æ
- å¯†é’¥æ£€æµ‹
- æ ¼å¼åŒ–å’Œ lint æ£€æŸ¥

### é«˜çº§é…ç½®

#### è‡ªå®šä¹‰æ‰«æé…ç½®

åœ¨ `scripts/security-scanner.cjs` ä¸­å¯ä»¥é…ç½®ï¼š

```javascript
const scanConfig = {
  // æ¼æ´ä¸¥é‡æ€§é˜ˆå€¼
  vulnerabilityThreshold: {
    critical: 0,    // ä¸å…è®¸ä¸¥é‡æ¼æ´
    high: 5,        // æœ€å¤š 5 ä¸ªé«˜å±æ¼æ´
    moderate: 10,   // æœ€å¤š 10 ä¸ªä¸­å±æ¼æ´
  },
  
  // æ‰«æèŒƒå›´
  scanScope: {
    dependencies: true,
    devDependencies: true,
    code: true,
    configuration: true,
    secrets: true,
  },
  
  // æŠ¥å‘Šæ ¼å¼
  reportFormat: ['json', 'console', 'sarif'],
};
```

#### ESLint å®‰å…¨è§„åˆ™

åœ¨ `.eslintrc.security.json` ä¸­é…ç½®å®‰å…¨è§„åˆ™ï¼š

```json
{
  "plugins": ["security", "sonarjs"],
  "rules": {
    "security/detect-object-injection": "error",
    "security/detect-non-literal-regexp": "error",
    "security/detect-unsafe-regex": "error",
    "security/detect-buffer-noassert": "error",
    "security/detect-child-process": "error",
    "security/detect-disable-mustache-escape": "error",
    "security/detect-eval-with-expression": "error",
    "security/detect-no-csrf-before-method-override": "error",
    "security/detect-non-literal-fs-filename": "error",
    "security/detect-non-literal-require": "error",
    "security/detect-possible-timing-attacks": "error",
    "security/detect-pseudoRandomBytes": "error"
  }
}
```

## æ‰«æç»“æœè§£è¯»

### å®‰å…¨è¯„åˆ†

ç³»ç»Ÿä¼šç”Ÿæˆ 0-100 çš„å®‰å…¨è¯„åˆ†ï¼š

- **90-100**: ä¼˜ç§€ - å®‰å…¨çŠ¶å†µè‰¯å¥½
- **80-89**: è‰¯å¥½ - æœ‰å°‘é‡éœ€è¦å…³æ³¨çš„é—®é¢˜
- **70-79**: ä¸€èˆ¬ - å­˜åœ¨ä¸€äº›å®‰å…¨é—®é¢˜éœ€è¦ä¿®å¤
- **60-69**: è¾ƒå·® - å­˜åœ¨è¾ƒå¤šå®‰å…¨é—®é¢˜
- **0-59**: å±é™© - å­˜åœ¨ä¸¥é‡å®‰å…¨é—®é¢˜ï¼Œéœ€è¦ç«‹å³å¤„ç†

### æ¼æ´ä¸¥é‡æ€§

- **Critical (ä¸¥é‡)**: ç«‹å³ä¿®å¤ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿå®Œå…¨å¦¥å
- **High (é«˜å±)**: å°½å¿«ä¿®å¤ï¼Œå¯èƒ½å¯¼è‡´é‡è¦æ•°æ®æ³„éœ²
- **Moderate (ä¸­å±)**: è®¡åˆ’ä¿®å¤ï¼Œå¯èƒ½å¯¼è‡´éƒ¨åˆ†åŠŸèƒ½å—å½±å“
- **Low (ä½å±)**: å¯é€‰ä¿®å¤ï¼Œå½±å“è¾ƒå°

### æŠ¥å‘Šæ–‡ä»¶

æ‰«æå®Œæˆåä¼šç”Ÿæˆä»¥ä¸‹æŠ¥å‘Šæ–‡ä»¶ï¼š

- `security-scan-report.json`: å®Œæ•´æ‰«ææŠ¥å‘Š
- `security-config-report.json`: é…ç½®å®‰å…¨æŠ¥å‘Š
- `audit-report.json`: ä¾èµ–å®¡è®¡æŠ¥å‘Š
- `eslint-security.json`: ä»£ç å®‰å…¨åˆ†ææŠ¥å‘Š

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ‰«æå¤±è´¥
```bash
# æ£€æŸ¥ä¾èµ–æ˜¯å¦æ­£ç¡®å®‰è£…
npm install

# éªŒè¯å®‰å…¨è‡ªåŠ¨åŒ–é…ç½®
npm run verify:security

# æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
npm run security:scan -- --verbose
```

#### 2. è¯¯æŠ¥å¤„ç†
```bash
# æŸ¥çœ‹å…·ä½“çš„è¯¯æŠ¥è§„åˆ™
npx eslint . --ext ts,tsx --format json

# åœ¨ .eslintrc.json ä¸­ç¦ç”¨ç‰¹å®šè§„åˆ™
{
  "rules": {
    "security/detect-object-injection": "off"
  }
}
```

#### 3. æ€§èƒ½é—®é¢˜
```bash
# ä½¿ç”¨å¿«é€Ÿæ‰«ææ¨¡å¼
npm run security:quick

# æ’é™¤ç‰¹å®šç›®å½•
# åœ¨ .eslintignore ä¸­æ·»åŠ ï¼š
node_modules/
dist/
build/
```

### è°ƒè¯•å·¥å…·

#### è¯¦ç»†æ—¥å¿—
```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
DEBUG=security:* npm run security:full

# æŸ¥çœ‹æ‰«æç»Ÿè®¡
npm run security:scan -- --stats
```

#### æ‰‹åŠ¨éªŒè¯
```bash
# æ‰‹åŠ¨è¿è¡Œ npm audit
npm audit --audit-level=moderate

# æ‰‹åŠ¨è¿è¡Œ ESLint å®‰å…¨æ£€æŸ¥
npx eslint . --ext ts,tsx --config .eslintrc.security.json

# æ£€æŸ¥å®‰å…¨å¤´é…ç½®
npm run test-security-headers
```

## æœ€ä½³å®è·µ

### å¼€å‘æµç¨‹é›†æˆ

1. **å¼€å‘å‰**: è¿è¡Œ `npm run verify:security` ç¡®ä¿ç¯å¢ƒé…ç½®æ­£ç¡®
2. **å¼€å‘ä¸­**: ä½¿ç”¨æ”¯æŒ ESLint çš„ç¼–è¾‘å™¨å®æ—¶æ£€æŸ¥å®‰å…¨é—®é¢˜
3. **æäº¤å‰**: Pre-commit é’©å­è‡ªåŠ¨è¿è¡Œå®‰å…¨æ£€æŸ¥
4. **åˆå¹¶å‰**: GitHub Actions è‡ªåŠ¨è¿è¡Œå®Œæ•´å®‰å…¨æ‰«æ
5. **éƒ¨ç½²å‰**: ç¡®ä¿æ‰€æœ‰å®‰å…¨æ£€æŸ¥é€šè¿‡

### æ¼æ´ç®¡ç†

1. **ä¼˜å…ˆçº§æ’åº**: æŒ‰ä¸¥é‡æ€§å’Œå½±å“èŒƒå›´æ’åº
2. **å¿«é€Ÿå“åº”**: ä¸¥é‡æ¼æ´ 24 å°æ—¶å†…ä¿®å¤
3. **å®šæœŸå®¡æŸ¥**: æ¯å‘¨å®¡æŸ¥ä¸­ä½å±æ¼æ´
4. **æ–‡æ¡£è®°å½•**: è®°å½•ä¿®å¤è¿‡ç¨‹å’Œå†³ç­–
5. **éªŒè¯ä¿®å¤**: ä¿®å¤åé‡æ–°æ‰«æéªŒè¯

### æŒç»­æ”¹è¿›

1. **å®šæœŸæ›´æ–°**: ä¿æŒæ‰«æå·¥å…·å’Œè§„åˆ™åº“æœ€æ–°
2. **è§„åˆ™è°ƒä¼˜**: æ ¹æ®é¡¹ç›®ç‰¹ç‚¹è°ƒæ•´æ‰«æè§„åˆ™
3. **å›¢é˜ŸåŸ¹è®­**: å®šæœŸè¿›è¡Œå®‰å…¨æ„è¯†åŸ¹è®­
4. **æµç¨‹ä¼˜åŒ–**: æ ¹æ®æ‰«æç»“æœä¼˜åŒ–å¼€å‘æµç¨‹
5. **æŒ‡æ ‡ç›‘æ§**: è·Ÿè¸ªå®‰å…¨æŒ‡æ ‡è¶‹åŠ¿

## ç›¸å…³æ–‡ä»¶

- `scripts/security-scanner.cjs` - ä¸»è¦å®‰å…¨æ‰«æè„šæœ¬
- `scripts/security-config-checker.cjs` - é…ç½®å®‰å…¨æ£€æŸ¥è„šæœ¬
- `scripts/verify-security-automation.cjs` - éªŒè¯è„šæœ¬
- `.github/workflows/security-scan.yml` - GitHub Actions å·¥ä½œæµ
- `.eslintrc.security.json` - ESLint å®‰å…¨é…ç½®
- `SECURITY.md` - å®‰å…¨ç­–ç•¥æ–‡æ¡£

## æ‰©å±•åŠŸèƒ½

### é›†æˆç¬¬ä¸‰æ–¹å·¥å…·

å¯ä»¥é›†æˆæ›´å¤šå®‰å…¨å·¥å…·ï¼š

- **Snyk**: å•†ä¸šæ¼æ´æ‰«ææœåŠ¡
- **WhiteSource**: å¼€æºç»„ä»¶å®‰å…¨ç®¡ç†
- **Checkmarx**: é™æ€åº”ç”¨å®‰å…¨æµ‹è¯•
- **OWASP ZAP**: åŠ¨æ€åº”ç”¨å®‰å…¨æµ‹è¯•

### è‡ªå®šä¹‰è§„åˆ™

å¯ä»¥æ·»åŠ é¡¹ç›®ç‰¹å®šçš„å®‰å…¨è§„åˆ™ï¼š

```javascript
// è‡ªå®šä¹‰å®‰å…¨æ£€æŸ¥
function checkCustomSecurity() {
  // æ£€æŸ¥ç‰¹å®šçš„å®‰å…¨æ¨¡å¼
  // ä¾‹å¦‚ï¼šAPI å¯†é’¥æ ¼å¼ã€ç‰¹å®šå‡½æ•°ä½¿ç”¨ç­‰
}
```

### æŠ¥å‘Šé›†æˆ

å¯ä»¥å°†æ‰«æç»“æœé›†æˆåˆ°å…¶ä»–ç³»ç»Ÿï¼š

- **Slack é€šçŸ¥**: å®‰å…¨é—®é¢˜å®æ—¶é€šçŸ¥
- **Jira é›†æˆ**: è‡ªåŠ¨åˆ›å»ºå®‰å…¨ä»»åŠ¡
- **ç›‘æ§ä»ªè¡¨æ¿**: å®‰å…¨æŒ‡æ ‡å¯è§†åŒ–
- **é‚®ä»¶æŠ¥å‘Š**: å®šæœŸå®‰å…¨çŠ¶å†µæŠ¥å‘Š
