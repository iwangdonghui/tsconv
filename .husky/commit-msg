#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ“ Validating commit message format..."

# Run commitlint to validate commit message
npx --no-install commitlint --edit "$1"
if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Commit message format is invalid!"
  echo ""
  echo "ğŸ“‹ Valid commit message format:"
  echo "   <type>[optional scope]: <description>"
  echo ""
  echo "ğŸ·ï¸  Valid types:"
  echo "   feat:     âœ¨ A new feature"
  echo "   fix:      ğŸ› A bug fix"
  echo "   docs:     ğŸ“š Documentation only changes"
  echo "   style:    ğŸ’ Changes that do not affect the meaning of the code"
  echo "   refactor: ğŸ“¦ A code change that neither fixes a bug nor adds a feature"
  echo "   perf:     ğŸš€ A code change that improves performance"
  echo "   test:     ğŸš¨ Adding missing tests or correcting existing tests"
  echo "   build:    ğŸ›   Changes that affect the build system or external dependencies"
  echo "   ci:       âš™ï¸  Changes to CI configuration files and scripts"
  echo "   chore:    â™»ï¸  Other changes that don't modify src or test files"
  echo "   revert:   ğŸ—‘  Reverts a previous commit"
  echo "   security: ğŸ”’ A code change that fixes a security issue"
  echo "   deps:     ğŸ“¦ A change to external dependencies"
  echo "   config:   ğŸ”§ A change to configuration files"
  echo ""
  echo "ğŸ“ Examples:"
  echo "   feat(auth): add user authentication"
  echo "   fix(api): resolve timeout issue in user endpoint"
  echo "   docs: update installation instructions"
  echo "   style: format code with prettier"
  echo ""
  echo "ğŸ’¡ Tip: Use 'npm run commit' for an interactive commit message builder"
  echo ""
  exit 1
fi

echo "âœ… Commit message format is valid!"
